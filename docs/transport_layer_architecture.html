<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PyRocketMQ è¿æ¥å±‚æ¶æ„è®¾è®¡å›¾</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            min-height: 100vh;
            padding: 20px;
            color: #2c3e50;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2d3436 0%, #636e72 100%);
            color: white;
            padding: 35px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.3em;
            margin-bottom: 12px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .content {
            padding: 35px;
        }

        .architecture-diagram {
            position: relative;
            width: 100%;
            min-height: 1000px;
            margin-bottom: 40px;
            background: #f8f9fa;
            border-radius: 12px;
            padding: 25px;
            overflow-x: auto;
        }

        /* SVGæ ·å¼å®šä¹‰ */
        .layer-box {
            fill: #ffffff;
            stroke: #2c3e50;
            stroke-width: 2;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
        }

        .application-layer {
            fill: #74b9ff;
        }

        .transport-layer {
            fill: #00b894;
        }

        .network-layer {
            fill: #fdcb6e;
        }

        .infrastructure-layer {
            fill: #e17055;
        }

        .component-box {
            fill: #ecf0f1;
            stroke: #95a5a6;
            stroke-width: 1.5;
        }

        .state-box {
            fill: #dfe6e9;
            stroke: #2d3436;
            stroke-width: 1.5;
        }

        .active-state {
            fill: #55efc4;
            stroke: #00b894;
        }

        .error-state {
            fill: #fab1a0;
            stroke: #d63031;
        }

        .config-box {
            fill: #e8f5e9;
            stroke: #4caf50;
            stroke-width: 2;
        }

        .connection-arrow {
            stroke: #2c3e50;
            stroke-width: 2;
            fill: none;
            marker-end: url(#arrowhead);
        }

        .async-arrow {
            stroke: #e74c3c;
            stroke-width: 2;
            fill: none;
            marker-end: url(#async-arrowhead);
            stroke-dasharray: 8, 4;
        }

        .data-flow {
            stroke: #3498db;
            stroke-width: 2;
            fill: none;
            marker-end: url(#data-arrowhead);
        }

        .state-transition {
            stroke: #9b59b6;
            stroke-width: 2;
            fill: none;
            marker-end: url(#state-arrowhead);
        }

        .text-title {
            font-size: 16px;
            font-weight: bold;
            fill: #2c3e50;
        }

        .text-label {
            font-size: 14px;
            fill: #34495e;
        }

        .text-small {
            font-size: 12px;
            fill: #7f8c8d;
        }

        .text-white {
            font-size: 16px;
            font-weight: bold;
            fill: white;
        }

        .state-section {
            background: #ecf0f1;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 35px;
        }

        .state-section h2 {
            color: #2c3e50;
            margin-bottom: 25px;
            font-size: 1.8em;
            border-bottom: 3px solid #3498db;
            padding-bottom: 12px;
        }

        .component-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 35px;
        }

        .component-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border-left: 5px solid #3498db;
        }

        .component-card h3 {
            color: #2980b9;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .component-card p {
            line-height: 1.7;
            color: #555;
            margin-bottom: 12px;
        }

        .component-card ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        .component-card li {
            margin-bottom: 8px;
            line-height: 1.6;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }

        .feature-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .feature-card h3 {
            font-size: 1.4em;
            margin-bottom: 15px;
        }

        .feature-card p {
            font-size: 0.95em;
            opacity: 0.9;
            line-height: 1.6;
        }

        .mechanism-section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 35px;
        }

        .mechanism-section h2 {
            color: #2c3e50;
            margin-bottom: 25px;
            font-size: 1.8em;
            border-bottom: 3px solid #00b894;
            padding-bottom: 12px;
        }

        .protocol-diagram {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 2px solid #dee2e6;
        }

        .protocol-box {
            display: inline-block;
            padding: 15px 25px;
            margin: 5px;
            border-radius: 5px;
            font-weight: bold;
            color: white;
            text-align: center;
        }

        .protocol-length {
            background: #e74c3c;
        }

        .protocol-header {
            background: #3498db;
        }

        .protocol-body {
            background: #2ecc71;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.9em;
            }

            .content {
                padding: 25px;
            }

            .component-grid,
            .feature-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”Œ PyRocketMQ è¿æ¥å±‚æ¶æ„è®¾è®¡</h1>
            <p>é«˜æ€§èƒ½TCPè¿æ¥ä¼ è¾“å±‚ - çŠ¶æ€æœºé©±åŠ¨çš„ç½‘ç»œé€šä¿¡æ¡†æ¶</p>
        </div>

        <div class="content">
            <!-- è¿æ¥å±‚æ¶æ„æ€»å›¾ -->
            <div class="architecture-diagram">
                <svg width="1300" height="1000" viewBox="0 0 1300 1000" xmlns="http://www.w3.org/2000/svg">
                    <!-- å®šä¹‰ç®­å¤´æ ‡è®° -->
                    <defs>
                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#2c3e50" />
                        </marker>
                        <marker id="async-arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#e74c3c" />
                        </marker>
                        <marker id="data-arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#3498db" />
                        </marker>
                        <marker id="state-arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#9b59b6" />
                        </marker>
                    </defs>

                    <!-- åº”ç”¨å±‚ -->
                    <rect x="50" y="50" width="1200" height="120" rx="10" class="layer-box"/>
                    <rect x="50" y="50" width="1200" height="40" rx="10" class="application-layer"/>
                    <text x="650" y="75" text-anchor="middle" class="text-white">åº”ç”¨å±‚ (Application Layer)</text>
                    <text x="650" y="145" text-anchor="middle" class="text-label">Producer | Consumer | BrokerClient | Remote</text>

                    <!-- ä¼ è¾“å±‚ -->
                    <rect x="50" y="200" width="1200" height="200" rx="10" class="layer-box"/>
                    <rect x="50" y="200" width="1200" height="40" rx="10" class="transport-layer"/>
                    <text x="650" y="225" text-anchor="middle" class="text-white">ä¼ è¾“å±‚ (Transport Layer)</text>

                    <!-- åŒæ­¥è¿æ¥çŠ¶æ€æœº -->
                    <rect x="80" y="260" width="520" height="120" rx="8" class="component-box"/>
                    <text x="340" y="285" text-anchor="middle" class="text-title">ConnectionStateMachine (åŒæ­¥)</text>
                    <text x="340" y="305" text-anchor="middle" class="text-small">è¿æ¥çŠ¶æ€ç®¡ç†ã€æ•°æ®æ”¶å‘ã€åŒæ­¥å¤„ç†</text>
                    <text x="340" y="325" text-anchor="middle" class="text-small">connect() | send() | receive() | close()</text>
                    <text x="340" y="345" text-anchor="middle" class="text-small">çŠ¶æ€: disconnected â†’ connecting â†’ connected â†’ closed</text>

                    <!-- å¼‚æ­¥è¿æ¥çŠ¶æ€æœº -->
                    <rect x="620" y="260" width="580" height="120" rx="8" class="component-box"/>
                    <text x="910" y="285" text-anchor="middle" class="text-title">AsyncConnectionStateMachine (å¼‚æ­¥)</text>
                    <text x="910" y="305" text-anchor="middle" class="text-small">å¼‚æ­¥è¿æ¥ç®¡ç†ã€äº‹ä»¶é©±åŠ¨ã€é«˜å¹¶å‘å¤„ç†</text>
                    <text x="910" y="325" text-anchor="middle" class="text-small">async connect() | async send() | async receive() | async close()</text>
                    <text x="910" y="345" text-anchor="middle" class="text-small">asyncioäº‹ä»¶å¾ªç¯ã€åç¨‹è°ƒåº¦ã€éé˜»å¡IO</text>

                    <!-- ç½‘ç»œå±‚ -->
                    <rect x="50" y="430" width="1200" height="150" rx="10" class="layer-box"/>
                    <rect x="50" y="430" width="1200" height="40" rx="10" class="network-layer"/>
                    <text x="650" y="455" text-anchor="middle" class="text-white">ç½‘ç»œå±‚ (Network Layer)</text>

                    <!-- TCPè¿æ¥ç®¡ç† -->
                    <rect x="80" y="490" width="280" height="70" rx="8" class="component-box"/>
                    <text x="220" y="515" text-anchor="middle" class="text-label">TCPè¿æ¥ç®¡ç†</text>
                    <text x="220" y="535" text-anchor="middle" class="text-small">Socketç®¡ç† | è¿æ¥æ± </text>

                    <!-- ç½‘ç»œé…ç½® -->
                    <rect x="380" y="490" width="280" height="70" rx="8" class="component-box"/>
                    <text x="520" y="515" text-anchor="middle" class="text-label">TCPé…ç½®ä¼˜åŒ–</text>
                    <text x="520" y="535" text-anchor="middle" class="text-small">NODELAY | KeepAlive | ç¼“å†²åŒº</text>

                    <!-- æ•°æ®åŒ…å¤„ç† -->
                    <rect x="680" y="490" width="280" height="70" rx="8" class="component-box"/>
                    <text x="820" y="515" text-anchor="middle" class="text-label">æ•°æ®åŒ…å¤„ç†</text>
                    <text x="820" y="535" text-anchor="middle" class="text-small">å°åŒ…/æ‹†åŒ… | æ ¡éªŒ | è·¯ç”±</text>

                    <!-- å¼‚å¸¸å¤„ç† -->
                    <rect x="980" y="490" width="240" height="70" rx="8" class="component-box"/>
                    <text x="1100" y="515" text-anchor="middle" class="text-label">å¼‚å¸¸å¤„ç†</text>
                    <text x="1100" y="535" text-anchor="middle" class="text-small">ç½‘ç»œå¼‚å¸¸ | è¶…æ—¶å¤„ç†</text>

                    <!-- åŸºç¡€è®¾æ–½å±‚ -->
                    <rect x="50" y="610" width="1200" height="150" rx="10" class="layer-box"/>
                    <rect x="50" y="610" width="1200" height="40" rx="10" class="infrastructure-layer"/>
                    <text x="650" y="635" text-anchor="middle" class="text-white">åŸºç¡€è®¾æ–½å±‚ (Infrastructure)</text>

                    <!-- é…ç½®ç®¡ç† -->
                    <rect x="80" y="670" width="260" height="70" rx="8" class="config-box"/>
                    <text x="210" y="695" text-anchor="middle" class="text-label">TransportConfig</text>
                    <text x="210" y="715" text-anchor="middle" class="text-small">é…ç½®ç®¡ç† | å‚æ•°éªŒè¯</text>

                    <!-- æ—¥å¿—ç³»ç»Ÿ -->
                    <rect x="360" y="670" width="260" height="70" rx="8" class="component-box"/>
                    <text x="490" y="695" text-anchor="middle" class="text-label">æ—¥å¿—ç³»ç»Ÿ</text>
                    <text x="490" y="715" text-anchor="middle" class="text-small">è¿æ¥æ—¥å¿— | æ€§èƒ½ç›‘æ§</text>

                    <!-- çŠ¶æ€è·Ÿè¸ª -->
                    <rect x="640" y="670" width="260" height="70" rx="8" class="component-box"/>
                    <text x="770" y="695" text-anchor="middle" class="text-label">çŠ¶æ€è·Ÿè¸ª</text>
                    <text x="770" y="715" text-anchor="middle" class="text-small">è¿æ¥çŠ¶æ€ | æ€§èƒ½æŒ‡æ ‡</text>

                    <!-- èµ„æºç®¡ç† -->
                    <rect x="920" y="670" width="300" height="70" rx="8" class="component-box"/>
                    <text x="1070" y="695" text-anchor="middle" class="text-label">èµ„æºç®¡ç†</text>
                    <text x="1070" y="715" text-anchor="middle" class="text-small">å†…å­˜ç®¡ç† | è¿æ¥æ±  | ç”Ÿå‘½å‘¨æœŸ</text>

                    <!-- çŠ¶æ€æœºè¯¦ç»†å›¾ -->
                    <g transform="translate(100, 780)">
                        <text x="500" y="-10" text-anchor="middle" class="text-title">è¿æ¥çŠ¶æ€æœºè½¬æ¢å›¾</text>

                        <!-- çŠ¶æ€èŠ‚ç‚¹ -->
                        <rect x="0" y="20" width="140" height="60" rx="30" class="state-box"/>
                        <text x="70" y="55" text-anchor="middle" class="text-label">DISCONNECTED</text>

                        <rect x="200" y="20" width="140" height="60" rx="30" class="state-box"/>
                        <text x="270" y="55" text-anchor="middle" class="text-label">CONNECTING</text>

                        <rect x="400" y="20" width="140" height="60" rx="30" class="active-state"/>
                        <text x="470" y="55" text-anchor="middle" class="text-label">CONNECTED</text>

                        <rect x="600" y="20" width="140" height="60" rx="30" class="error-state"/>
                        <text x="670" y="55" text-anchor="middle" class="text-label">CLOSED</text>

                        <rect x="800" y="20" width="140" height="60" rx="30" class="state-box"/>
                        <text x="870" y="55" text-anchor="middle" class="text-label">CLOSING</text>

                        <!-- çŠ¶æ€è½¬æ¢ç®­å¤´ -->
                        <path d="M 140 50 L 200 50" class="state-transition"/>
                        <text x="170" y="40" text-anchor="middle" class="text-small">connect()</text>

                        <path d="M 340 50 L 400 50" class="state-transition"/>
                        <text x="370" y="40" text-anchor="middle" class="text-small">è¿æ¥æˆåŠŸ</text>

                        <path d="M 540 50 L 600 50" class="state-transition"/>
                        <text x="570" y="40" text-anchor="middle" class="text-small">close()</text>

                        <path d="M 740 50 L 800 50" class="state-transition"/>
                        <text x="770" y="40" text-anchor="middle" class="text-small">å…³é—­ä¸­</text>

                        <!-- åå‘è½¬æ¢ -->
                        <path d="M 270 80 Q 270 130, 70 130 Q 70 130, 70 80" class="state-transition" stroke-dasharray="5,5"/>
                        <text x="170" y="145" text-anchor="middle" class="text-small">è¿æ¥å¤±è´¥</text>

                        <path d="M 470 80 Q 470 120, 270 120 Q 270 120, 270 80" class="state-transition" stroke-dasharray="5,5"/>
                        <text x="370" y="135" text-anchor="middle" class="text-small">è¿æ¥æ–­å¼€</text>
                    </g>

                    <!-- å±‚é—´è¿æ¥ç®­å¤´ -->
                    <path d="M 650 170 L 650 200" class="connection-arrow"/>
                    <text x="670" y="185" class="text-small">è°ƒç”¨ä¼ è¾“å±‚</text>

                    <path d="M 650 400 L 650 430" class="connection-arrow"/>
                    <text x="670" y="415" class="text-small">ç½‘ç»œé€šä¿¡</text>

                    <path d="M 650 580 L 650 610" class="connection-arrow"/>
                    <text x="670" y="595" class="text-small">åŸºç¡€è®¾æ–½æ”¯æŒ</text>

                    <!-- å¼‚æ­¥æµ -->
                    <path d="M 590 320 L 620 320" class="async-arrow"/>
                    <text x="605" y="310" text-anchor="middle" class="text-small">asyncæ”¯æŒ</text>

                </svg>
            </div>

            <!-- æ ¸å¿ƒç»„ä»¶è¯¦è§£ -->
            <div class="component-grid">
                <div class="component-card">
                    <h3>ğŸ”„ ConnectionStateMachine (åŒæ­¥è¿æ¥çŠ¶æ€æœº)</h3>
                    <p><strong>æ ¸å¿ƒåŠŸèƒ½ï¼š</strong>ç®¡ç†TCPè¿æ¥çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸï¼Œæä¾›å¯é çš„æ•°æ®ä¼ è¾“æœåŠ¡ã€‚</p>
                    <p><strong>ä¸»è¦æ–¹æ³•ï¼š</strong></p>
                    <ul>
                        <li><code>connect()</code> - å»ºç«‹TCPè¿æ¥</li>
                        <li><code>send_data()</code> - å‘é€æ•°æ®</li>
                        <li><code>receive_data()</code> - æ¥æ”¶æ•°æ®</li>
                        <li><code>close()</code> - å…³é—­è¿æ¥</li>
                        <li><code>is_connected()</code> - æ£€æŸ¥è¿æ¥çŠ¶æ€</li>
                    </ul>
                    <p><strong>çŠ¶æ€ç®¡ç†ï¼š</strong>DISCONNECTED â†’ CONNECTING â†’ CONNECTED â†’ CLOSED</p>
                </div>

                <div class="component-card">
                    <h3>âš¡ AsyncConnectionStateMachine (å¼‚æ­¥è¿æ¥çŠ¶æ€æœº)</h3>
                    <p><strong>æ ¸å¿ƒåŠŸèƒ½ï¼š</strong>åŸºäºasyncioçš„é«˜æ€§èƒ½å¼‚æ­¥è¿æ¥ç®¡ç†ï¼Œæ”¯æŒå¤§è§„æ¨¡å¹¶å‘è¿æ¥ã€‚</p>
                    <p><strong>ä¸»è¦æ–¹æ³•ï¼š</strong></p>
                    <ul>
                        <li><code>async connect()</code> - å¼‚æ­¥å»ºç«‹è¿æ¥</li>
                        <li><code>async send_data()</code> - å¼‚æ­¥å‘é€æ•°æ®</li>
                        <li><code>async receive_data()</code> - å¼‚æ­¥æ¥æ”¶æ•°æ®</li>
                        <li><code>async close()</code> - å¼‚æ­¥å…³é—­è¿æ¥</li>
                        <li><code>async wait_for_event()</code> - ç­‰å¾…è¿æ¥äº‹ä»¶</li>
                    </ul>
                    <p><strong>æ€§èƒ½ä¼˜åŠ¿ï¼š</strong>éé˜»å¡IOã€äº‹ä»¶é©±åŠ¨ã€åç¨‹è°ƒåº¦</p>
                </div>

                <div class="component-card">
                    <h3>âš™ï¸ TransportConfig (ä¼ è¾“å±‚é…ç½®)</h3>
                    <p><strong>æ ¸å¿ƒåŠŸèƒ½ï¼š</strong>ç»Ÿä¸€çš„ä¼ è¾“å±‚é…ç½®ç®¡ç†ï¼Œæ”¯æŒç½‘ç»œå‚æ•°è°ƒä¼˜å’Œæ€§èƒ½ä¼˜åŒ–ã€‚</p>
                    <p><strong>ä¸»è¦é…ç½®é¡¹ï¼š</strong></p>
                    <ul>
                        <li><code>host/port</code> - æœåŠ¡å™¨åœ°å€å’Œç«¯å£</li>
                        <li><code>connect_timeout</code> - è¿æ¥è¶…æ—¶æ—¶é—´</li>
                        <li><code>read_timeout</code> - è¯»å–è¶…æ—¶æ—¶é—´</li>
                        <li><code>tcp_nodelay</code> - TCP_NODELAYé€‰é¡¹</li>
                        <li><code>tcp_keepalive</code> - TCP KeepAliveé…ç½®</li>
                        <li><code>buffer_size</code> - ç¼“å†²åŒºå¤§å°</li>
                    </ul>
                    <p><strong>ç‰¹æ€§ï¼š</strong>é…ç½®éªŒè¯ã€å‚æ•°å¤åˆ¶ã€åºåˆ—åŒ–æ”¯æŒ</p>
                </div>

                <div class="component-card">
                    <h3>ğŸŒ TCPé…ç½®ä¼˜åŒ–</h3>
                    <p><strong>æ ¸å¿ƒåŠŸèƒ½ï¼š</strong>é€šè¿‡TCPå‚æ•°è°ƒä¼˜ï¼Œæå‡ç½‘ç»œä¼ è¾“æ€§èƒ½å’Œç¨³å®šæ€§ã€‚</p>
                    <p><strong>ä¼˜åŒ–é…ç½®ï¼š</strong></p>
                    <ul>
                        <li><strong>TCP_NODELAYï¼š</strong>ç¦ç”¨Nagleç®—æ³•ï¼Œå‡å°‘å»¶è¿Ÿ</li>
                        <li><strong>TCP KeepAliveï¼š</strong>è‡ªåŠ¨æ£€æµ‹è¿æ¥å­˜æ´»æ€§</li>
                        <li><strong>SO_REUSEADDRï¼š</strong>åœ°å€é‡ç”¨</li>
                        <li><strong>ç¼“å†²åŒºä¼˜åŒ–ï¼š</strong>è°ƒæ•´å‘é€å’Œæ¥æ”¶ç¼“å†²åŒºå¤§å°</li>
                        <li><strong>è¿æ¥è¶…æ—¶ï¼š</strong>åˆç†çš„è¿æ¥å’Œè¯»å†™è¶…æ—¶è®¾ç½®</li>
                    </ul>
                    <p><strong>æ€§èƒ½æå‡ï¼š</strong>ä½å»¶è¿Ÿã€é«˜ååé‡ã€ç¨³å®šæ€§</p>
                </div>
            </div>

            <!-- çŠ¶æ€æœºè¯¦è§£ -->
            <div class="state-section">
                <h2>ğŸ”„ çŠ¶æ€æœºè®¾è®¡è¯¦è§£</h2>
                <div class="component-grid">
                    <div class="component-card">
                        <h3>ğŸ“± DISCONNECTED (æ–­å¼€è¿æ¥)</h3>
                        <p><strong>çŠ¶æ€æè¿°ï¼š</strong>åˆå§‹çŠ¶æ€æˆ–è¿æ¥æ–­å¼€åçš„çŠ¶æ€ï¼Œè¿æ¥ä¸å¯ç”¨ã€‚</p>
                        <p><strong>è§¦å‘æ¡ä»¶ï¼š</strong></p>
                        <ul>
                            <li>å¯¹è±¡åˆ›å»ºæ—¶çš„åˆå§‹çŠ¶æ€</li>
                            <li>è¿æ¥å¤±è´¥æˆ–å¼‚å¸¸æ–­å¼€å</li>
                            <li>ä¸»åŠ¨å…³é—­è¿æ¥å</li>
                        </ul>
                        <p><strong>å¯æ‰§è¡Œæ“ä½œï¼š</strong>connect()</p>
                        <p><strong>ä¸‹ä¸€çŠ¶æ€ï¼š</strong>CONNECTING</p>
                    </div>

                    <div class="component-card">
                        <h3>ğŸ”Œ CONNECTING (è¿æ¥ä¸­)</h3>
                        <p><strong>çŠ¶æ€æè¿°ï¼š</strong>æ­£åœ¨å»ºç«‹TCPè¿æ¥çš„è¿‡ç¨‹ä¸­ï¼Œè¿æ¥å°šæœªå°±ç»ªã€‚</p>
                        <p><strong>è§¦å‘æ¡ä»¶ï¼š</strong></p>
                        <ul>
                            <li>è°ƒç”¨connect()æ–¹æ³•</li>
                            <li>é‡è¿æœºåˆ¶è§¦å‘</li>
                        </ul>
                        <p><strong>å¯æ‰§è¡Œæ“ä½œï¼š</strong>ç­‰å¾…è¿æ¥ç»“æœ</p>
                        <p><strong>ä¸‹ä¸€çŠ¶æ€ï¼š</strong>CONNECTED (æˆåŠŸ) æˆ– DISCONNECTED (å¤±è´¥)</p>
                    </div>

                    <div class="component-card">
                        <h3>âœ… CONNECTED (å·²è¿æ¥)</h3>
                        <p><strong>çŠ¶æ€æè¿°ï¼š</strong>TCPè¿æ¥å·²æˆåŠŸå»ºç«‹ï¼Œå¯ä»¥è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚</p>
                        <p><strong>è§¦å‘æ¡ä»¶ï¼š</strong></p>
                        <ul>
                            <li>è¿æ¥æ¡æ‰‹æˆåŠŸ</li>
                            <li>è®¤è¯é€šè¿‡ (å¦‚æœéœ€è¦)</li>
                        </ul>
                        <p><strong>å¯æ‰§è¡Œæ“ä½œï¼š</strong>send_data()ã€receive_data()</p>
                        <p><strong>ä¸‹ä¸€çŠ¶æ€ï¼š</strong>CLOSED (ä¸»åŠ¨å…³é—­) æˆ– DISCONNECTED (å¼‚å¸¸æ–­å¼€)</p>
                    </div>

                    <div class="component-card">
                        <h3>ğŸ”’ CLOSING (å…³é—­ä¸­)</h3>
                        <p><strong>çŠ¶æ€æè¿°ï¼š</strong>æ­£åœ¨å…³é—­è¿æ¥çš„è¿‡ç¨‹ä¸­ï¼Œæ¸…ç†èµ„æºå’Œæ•°æ®ã€‚</p>
                        <p><strong>è§¦å‘æ¡ä»¶ï¼š</strong></p>
                        <ul>
                            <li>è°ƒç”¨close()æ–¹æ³•</li>
                            <li>è¿æ¥è¢«ç¨‹åºä¸»åŠ¨ç»ˆæ­¢</li>
                        </ul>
                        <p><strong>å¯æ‰§è¡Œæ“ä½œï¼š</strong>ç­‰å¾…å…³é—­å®Œæˆ</p>
                        <p><strong>ä¸‹ä¸€çŠ¶æ€ï¼š</strong>CLOSED</p>
                    </div>

                    <div class="component-card">
                        <h3>âŒ CLOSED (å·²å…³é—­)</h3>
                        <p><strong>çŠ¶æ€æè¿°ï¼š</strong>è¿æ¥å·²å®Œå…¨å…³é—­ï¼Œæ‰€æœ‰èµ„æºå·²é‡Šæ”¾ã€‚</p>
                        <p><strong>è§¦å‘æ¡ä»¶ï¼š</strong></p>
                        <ul>
                            <li>CLOSINGçŠ¶æ€å®Œæˆå…³é—­æµç¨‹</li>
                            <li>è¿æ¥å‡ºç°ä¸å¯æ¢å¤çš„é”™è¯¯</li>
                        </ul>
                        <p><strong>å¯æ‰§è¡Œæ“ä½œï¼š</strong>æ—  (éœ€è¦é‡æ–°åˆ›å»ºå¯¹è±¡)</p>
                        <p><strong>ä¸‹ä¸€çŠ¶æ€ï¼š</strong>æ—  (ç»ˆç«¯çŠ¶æ€)</p>
                    </div>
                </div>
            </div>

            <!-- æ•°æ®ä¼ è¾“æœºåˆ¶ -->
            <div class="mechanism-section">
                <h2>ğŸ“¡ æ•°æ®ä¼ è¾“æœºåˆ¶</h2>

                <h3 style="margin-top: 20px; margin-bottom: 15px; color: #2c3e50;">ğŸ”¢ æ•°æ®åŒ…æ ¼å¼</h3>
                <div class="protocol-diagram">
                    <span class="protocol-box protocol-length">Length (4 bytes)</span>
                    <span class="protocol-box protocol-header">Header Data (JSON)</span>
                    <span class="protocol-box protocol-body">Body Data (bytes)</span>
                    <p style="margin-top: 15px; text-align: center; color: #666;">
                        <strong>è¯´æ˜ï¼š</strong>4å­—èŠ‚é•¿åº¦å¤´ + JSONæ ¼å¼å¤´ä¿¡æ¯ + äºŒè¿›åˆ¶æ¶ˆæ¯ä½“
                    </p>
                </div>

                <div class="component-grid" style="margin-top: 25px;">
                    <div class="component-card">
                        <h3>ğŸ“¤ å‘é€æœºåˆ¶</h3>
                        <p><strong>å¤„ç†æµç¨‹ï¼š</strong></p>
                        <ul>
                            <li>åºåˆ—åŒ–æ¶ˆæ¯å¤´ä¸ºJSONæ ¼å¼</li>
                            <li>è®¡ç®—æ€»é•¿åº¦å¹¶å†™å…¥4å­—èŠ‚å¤´éƒ¨</li>
                            <li>å‘é€å®Œæ•´æ•°æ®åŒ… (Length + Header + Body)</li>
                            <li>å¤„ç†å‘é€å¼‚å¸¸å’Œé‡è¯•</li>
                        </ul>
                        <p><strong>ä¼˜åŒ–ç‰¹æ€§ï¼š</strong>æ‰¹é‡å‘é€ã€ç¼“å†²åŒºç®¡ç†ã€é›¶æ‹·è´</p>
                    </div>

                    <div class="component-card">
                        <h3>ğŸ“¥ æ¥æ”¶æœºåˆ¶</h3>
                        <p><strong>å¤„ç†æµç¨‹ï¼š</strong></p>
                        <ul>
                            <li>å…ˆè¯»å–4å­—èŠ‚é•¿åº¦ä¿¡æ¯</li>
                            <li>æ ¹æ®é•¿åº¦ç²¾ç¡®æ¥æ”¶å‰©ä½™æ•°æ®</li>
                            <li>è§£æJSONå¤´éƒ¨å’ŒäºŒè¿›åˆ¶æ¶ˆæ¯ä½“</li>
                            <li>æ•°æ®å®Œæ•´æ€§æ ¡éªŒ</li>
                        </ul>
                        <p><strong>ç²¾ç¡®æ¥æ”¶ï¼š</strong>_recv_exactly()ç¡®ä¿å®Œæ•´æ¥æ”¶æŒ‡å®šå­—èŠ‚æ•°</p>
                    </div>
                </div>
            </div>

            <!-- æ¶æ„ç‰¹æ€§ -->
            <h2 style="color: #2c3e50; margin-bottom: 25px; font-size: 1.8em; border-bottom: 3px solid #0984e3; padding-bottom: 12px;">ğŸš€ æ¶æ„æ ¸å¿ƒç‰¹æ€§</h2>
            <div class="feature-grid">
                <div class="feature-card">
                    <h3>ğŸ”„ åŒæ¨¡å¼æ”¯æŒ</h3>
                    <p>åŒæ—¶æä¾›åŒæ­¥å’Œå¼‚æ­¥ä¸¤ç§è¿æ¥çŠ¶æ€æœºå®ç°ï¼Œæ»¡è¶³ä¸åŒæ€§èƒ½éœ€æ±‚å’Œåœºæ™¯è¦æ±‚ã€‚åŒæ­¥æ¨¡å¼ç®€å•æ˜“ç”¨ï¼Œå¼‚æ­¥æ¨¡å¼æ€§èƒ½å“è¶Šã€‚</p>
                </div>
                <div class="feature-card">
                    <h3>âš¡ é«˜æ€§èƒ½è®¾è®¡</h3>
                    <p>åŸºäºçŠ¶æ€æœºçš„è¿æ¥ç®¡ç†ï¼ŒTCPå‚æ•°ä¼˜åŒ–ï¼Œç¼“å†²åŒºç®¡ç†ï¼Œé›¶æ‹·è´æŠ€æœ¯ï¼Œç¡®ä¿ä½å»¶è¿Ÿã€é«˜ååé‡çš„ç½‘ç»œä¼ è¾“æ€§èƒ½ã€‚</p>
                </div>
                <div class="feature-card">
                    <h3>ğŸ›¡ï¸ å¯é æ€§ä¿éšœ</h3>
                    <p>å®Œå–„çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼Œè¿æ¥çŠ¶æ€è·Ÿè¸ªï¼Œè‡ªåŠ¨é‡è¿ï¼Œå¿ƒè·³æ£€æµ‹ï¼Œç¡®ä¿åœ¨å„ç§ç½‘ç»œç¯å¢ƒä¸‹çš„è¿æ¥ç¨³å®šæ€§ã€‚</p>
                </div>
                <div class="feature-card">
                    <h3>ğŸ“Š çŠ¶æ€ç®¡ç†</h3>
                    <p>ç²¾ç¡®çš„çŠ¶æ€æœºè®¾è®¡ï¼Œæ¸…æ™°çš„çŠ¶æ€è½¬æ¢é€»è¾‘ï¼Œä¸°å¯Œçš„å›è°ƒæœºåˆ¶ï¼Œä¾¿äºç›‘æ§å’Œè°ƒè¯•è¿æ¥çŠ¶æ€å˜åŒ–ã€‚</p>
                </div>
                <div class="feature-card">
                    <h3>ğŸ”§ é…ç½®çµæ´»</h3>
                    <p>ä¸°å¯Œçš„é…ç½®é€‰é¡¹ï¼Œæ”¯æŒç½‘ç»œå‚æ•°è°ƒä¼˜ï¼Œè¶…æ—¶è®¾ç½®ï¼Œç¼“å†²åŒºé…ç½®ï¼Œæ»¡è¶³ä¸åŒåº”ç”¨åœºæ™¯çš„æ€§èƒ½éœ€æ±‚ã€‚</p>
                </div>
                <div class="feature-card">
                    <h3>ğŸ“ˆ å¯æ‰©å±•æ€§</h3>
                    <p>æ¨¡å—åŒ–è®¾è®¡ï¼Œæ¸…æ™°çš„æ¥å£å®šä¹‰ï¼Œä¾¿äºæ‰©å±•æ–°çš„ä¼ è¾“åè®®å’ŒåŠŸèƒ½ç‰¹æ€§ï¼Œæ”¯æŒæ’ä»¶å¼æ¶æ„æ‰©å±•ã€‚</p>
                </div>
            </div>

            <!-- ä½¿ç”¨ç¤ºä¾‹ -->
            <div class="mechanism-section">
                <h2>ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹</h2>
                <div class="component-grid">
                    <div class="component-card">
                        <h3>ğŸ”„ åŒæ­¥è¿æ¥ä½¿ç”¨</h3>
                        <p><strong>åˆ›å»ºè¿æ¥ï¼š</strong></p>
                        <pre style="background: #f8f9fa; padding: 15px; border-radius: 5px; overflow-x: auto;">
config = TransportConfig(
    host="localhost",
    port=9876,
    connect_timeout=5000.0,
    read_timeout=30000.0
)

connection = ConnectionStateMachine(config)
connection.connect()
data = connection.receive_data()
connection.send_data(response)
connection.close()
                        </pre>
                    </div>

                    <div class="component-card">
                        <h3>âš¡ å¼‚æ­¥è¿æ¥ä½¿ç”¨</h3>
                        <p><strong>å¼‚æ­¥æ“ä½œï¼š</strong></p>
                        <pre style="background: #f8f9fa; padding: 15px; border-radius: 5px; overflow-x: auto;">
async def async_example():
    config = TransportConfig(
        host="localhost",
        port=9876,
        connect_timeout=5000.0
    )

    connection = AsyncConnectionStateMachine(config)
    await connection.connect()
    data = await connection.receive_data()
    await connection.send_data(response)
    await connection.close()
                        </pre>
                    </div>
                </div>
            </div>

        </div>
    </div>
</body>
</html>
